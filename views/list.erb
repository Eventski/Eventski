<%= @mtn.mountain_name %></p>
<%= @mtn.mountain_city %></p>
<%= @mtn.mountain_state %></p>
<%= @mtn.mountain_url %></p>
<%= @mtn.mountain_lat %>;
<%= @mtn.mountain_long %>
<% @mtn.id %>

<div id='shows'>
  <table>
    <thead>
      <th>
        Name
      </th>
      <th>
        Date
      </th>
      <th>
        Location
      </th>
      <th>
        URL
      </th>
      <th>
        Save Show
      </th>
    </thead>
    <tbody>
      <tr>
        <td id="name">

        </td>
        <td id="date">

        </td>
        <td id="location">

        </td>
        <td id="url">

        </td>
        <td id="save">

        </td>
      </tr>
    </tbody>
  </table>
</div>

<script type="text/javascript">
var artistArray = [];
$.getJSON("http://api.songkick.com/api/3.0/events.json?location=geo:" + <%= @mtn.mountain_lat %> + "," + <%= @mtn.mountain_long %> + "&apikey=NGGZAUSLFDnYDLrV&jsoncallback=?",
function(data){
  console.log(data);
  for (i=0; i< data.resultsPage.totalEntries; i++){
    var name = data.resultsPage.results.event[i].performance[0].artist.displayName;
    var date = data.resultsPage.results.event[i].start.date;
    var location = data.resultsPage.results.event[i].location.city;
    var url = data.resultsPage.results.event[i].performance[0].artist.uri;

    var currentShow = new Object();
    currentShow.name = name;
    currentShow.date = date;
    currentShow.location = location;
    currentShow.url = url;

    // $("#shows").append(currentShow.name);
    artistArray.push(currentShow);
  }
  for (var i = 0; i < artistArray.length; i++) {
    console.log(artistArray[i].name)
    $("#name").append(artistArray[i].name + '</p>');
    $("#date").append(artistArray[i].date + '</p>');
    $("#location").append(artistArray[i].location + '</p>');
    $("#url").append(artistArray[i].url + '</p>');
    $("#save").append("<a href='events/save'>Save</a>" +'</p>');
  }
})

var dateVar = 2016-04-08;
var nameVar = "testtttt";
var urlVar = "http://www.songkick.com";
var mtnVar = 1;

var dataVar = {date: '1/1/1', name: 'test', url: 'google.com', mountalin: 1};

// var dataSend = {
//   type: "POST",
//   url: '/events/save',
//   dataType: 'json',
//   data: dataVar
// }

////////////////BELOW IS WORKING VERSION
var dataSend = {
  type: "post",
  url: '/events/save',
  dataType: 'json',
  data: {
    date: 2016-04-08,
    name: "The Tsunamibots",
    url: "http://www.songkick.com/artists/8451818-tsunamibots?utm_source=37912&utm_medium=partner",
    mountain:1
  }
}

////////////////
$("#save").click(function(){
  $.ajax(dataSend);
})



</script>
